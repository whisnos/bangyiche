define("app/ms_v2/js/common/feedback.js",["jquery","app/ms_v2/js/base.js","widget/dialog/dialog.js","app/ms_v2/css/feedback.css"],function(e,i){var t=i,s=e("jquery");e("app/ms_v2/js/base.js");var a=e("widget/dialog/dialog.js");e("app/ms_v2/css/feedback.css");var o="请填写您的遇到的问题，我们会第一时间处理，字数请控制在500字内",c="请填写您的手机号，方便我们联系您",n="请输入验证码",l="字数超过限制，请输入字数在5-500字内",d="请输入正确的手机号",r="请输入正确的验证码",_="投诉与建议",f='<div class="pop_feedback">    <div class="pop_box_content">        <div class="mt10 clearfix">            <div class="form_item">                <label><em class="xing">*</em> 反馈类型</label>                <div class="select_type" id="f_type"><span class="on" value="5" id="f_type_jy"><i></i>建议反馈</span><span value="6" id="f_type_ts"><i></i>投诉反馈</span></div>            </div>            <div class="form_item">                <label><em class="xing">*</em> 反馈内容</label>                <textarea id="f_content" class="textarea1">'+o+"</textarea>"+'                <p class="error_text" id="f_content_error" style="display:none;"><i></i>'+l+"</p>"+"            </div>"+'            <div class="form_item">'+'                <label><em class="xing" id="mobile_need"></em>联系电话</label>'+'                <input id="f_mobile" type="text" class="input1" value="'+c+'" />'+'                <p class="error_text" id="f_mobile_error" style="display:none;"><i></i>'+d+"</p>"+"            </div>"+'            <div class="form_item" id="f_img_code" style="display:none;">'+"                <label>验&nbsp;证&nbsp;码</label>"+'                <input id="f_image_code" type="text" class="input2" value="请输入验证码" /><a href="javascript:;" title="单击刷新验证码"><img id="js_image_code" src="http://www.273.cn/ajax.php?module=code"></a>'+'                <p class="error_text" id="f_image_code_error" style="display:none;"><i></i>'+r+"</p>"+"            </div>"+'            <div class="form_item">'+'                <div class="btn_box"><button data-eqselog="/feedback/@etype=click@btn=submit" class="button1" id="f_submit">提交</button><button data-eqselog="/feedback/@etype=click@btn=cancel" class="button2" id="f_cancel">取消</button></div>'+'                <p>如需人工帮助，请联系客服，联系电话：<strong class="color-cheng">400-6000-273</strong></p>'+"            </div>"+'            <input type="hidden" id="f_show_image_code" value="0" />'+"        </div>"+"    </div>"+"</div>",m='<div class="pop_feedback">    <div class="pop_box_content">        <div class="success_tips clearfix">            <div class="icon"></div>            <p>                <strong>感谢您的反馈！我们将第一时间跟进处理!</strong>                本窗口将在 <em id="time">5</em>秒后自动关闭            </p>        </div>    </div></div>';t.dialog=null,t.createDialog=function(e,i){var t={title:e,padding:"0px",escAble:!0,skin:"gray",content:i,close:null};return new a(t)},t.pop=function(e){var i=this;e.live("click",function(){i.dialog=i.createDialog(_,f)})},t.success=function(e,i,t){var a=this.createDialog(e,i);!function(){t>0?(s("#time").html(t),t--,setTimeout(arguments.callee,1e3)):a.close()}()},t.checkContent=function(e){return s("#f_content_error").hide(),s("#f_content").removeClass("border-red"),e.length<5||e.length>500||e==o?(s("#f_content_error").show(),s("#f_content").addClass("border-red"),!1):!0},t.checkMobile=function(e){s("#f_mobile_error").hide(),s("#f_mobile").removeClass("border-red");var i=/^1[3458]\d{9}$|^(0\d{2,4}-)?[2-9]\d{6,7}(-\d{2,5})?$|^(?!\d+(-\d+){3,})[48]00(-?\d){7,10}$/;return i.test(e)?!0:(s("#f_mobile_error").show(),s("#f_mobile").addClass("border-red"),!1)},t.focusInOut=function(e,i){e.live("focus",function(){s(this).val()==i&&s(this).val("")}).live("blur",function(){s(this).val()||s(this).val(i)})},t.generateCode=function(e){e.live("click",function(){s(this).attr("src","http://www.273.cn/ajax.php?module=code&"+Math.random())})},t.submit=function(e){var i=this;e.live("click",function(){var e=s("#f_type .on").attr("value"),t=s("#f_content").val(),a=s("#f_mobile").val(),o=s("#f_image_code").val(),n=s("#f_show_image_code").val(),l=window.location.href,d=i.checkContent(t),r=a!=c||6==e?i.checkMobile(a):!0;a==c&&(a="-"),d&&r&&s.ajax({url:"http://www.273.cn/ajax.php?module=Feedback",type:"GET",dataType:"jsonp",data:{type:e,content:t,mobile:a,image_code:o,show_image_code:n,url:l},beforeSend:function(){s("#f_submit").removeClass("button1").addClass("button2").html("提交中...")},success:function(e){s("#f_submit").removeClass("button2").addClass("button1").html("提交"),s("#f_image_code_error").hide(),s("#f_image_code").removeClass("border-red"),3==e.status&&(s("#f_img_code").show(),s("#f_show_image_code").val(1),s("#js_image_code").click()),1==e.status&&(s("#f_image_code_error").show(),s("#f_image_code").addClass("border-red")),0==e.status&&(i.dialog.close(),i.success(_,m,5))}})})},t.cancel=function(e){var i=this;e.live("click",function(){i.dialog.close()})},t.switchType=function(e){e.find("span").live("click",function(){s(this).addClass("on").siblings("span").removeClass("on")}),e.find("#f_type_jy").live("click",function(){s("#mobile_need").html("")}),e.find("#f_type_ts").live("click",function(){s("#mobile_need").html("* ")})},t.switchType(s("#f_type")),t.focusInOut(s("#f_content"),o),t.focusInOut(s("#f_mobile"),c),t.focusInOut(s("#f_image_code"),n),t.generateCode(s("#js_image_code")),t.submit(s("#f_submit")),t.cancel(s("#f_cancel")),t.init=function(e){t.pop(e.$el)}});